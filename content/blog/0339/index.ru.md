---
date: "2018-07-02T00:00:00Z"
title: "Медленное подключение к MySQL в Docker"
tags: ["Docker", "Linux", "MySQL", "контейнеры", "разработка"]
image: "https://3.bp.blogspot.com/-KfGkUuzJYBQ/WzpDheKD1ZI/AAAAAAAAsqo/H970WSIWmPgOu7qEpqPfUHUDIljzALuigCKgBGAs/s1600/mysql.png"
---

На моём текущем проекте я разрабатываю приложение, использующее {{< fl "MySQL" >}} в качестве базы данных. Сама база данных крутится в {{< fl "Docker" >}}-контейнере, что очень удобно.

В какой-то момент приложение стало запускаться безумно долго,  проверка показала, что каждое подключение к серверу {{< fl "MySQL" >}} стало занимать чуть не полминуты. Учитывая, что соединение устанавливалось несколько сотен раз, запуск приложения стал *чуть-чуть слишком медленным*.

После этого я потратил кучу времени, чтобы найти решение, и даже {{< fl "StackOverflow" >}} не мог мне помочь. Но в конце концов разобрался.

<!--more-->
<!--{{< imgfig "https://3.bp.blogspot.com/-KfGkUuzJYBQ/WzpDheKD1ZI/AAAAAAAAsqo/H970WSIWmPgOu7qEpqPfUHUDIljzALuigCKgBGAs/s1600/mysql.png" >}}-->

Всё дело, как я изначально, предполагал, в {{< fl "DNS" >}}: база данных пытается определить, какой хост к ней подключается. В моём случае это совершенно бессмысленная операция. Использование флага Докера `--dns=127.0.0.1` не помогало.

Помог флаг самой {{< fl "MySQL" >}} `--skip-name-resolve`: проблема исчезла безвозвратно и соединение устанавливается в считанные миллисекунды.

Запускать контейнер можно примерно так:

```
docker run -e MYSQL_ROOT_PASSWORD=secret mysql:5.7.16 --skip-name-resolve
```

Не благодарите.

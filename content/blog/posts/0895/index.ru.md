---
type: post
date: "2024-09-15T16:16:07+02:00"
title: "3.10.0 Donaghadee"
tags:
    - Comentario
    - веб
    - софт
    - разработка
    - релиз
    - Go
    - Angular
image: "https://res.cloudinary.com/yktoo/image/upload/v1726409725/blog/ni6elgzbaxv5cemqgbga.jpg"
imageCredit: "Изображение: кибермозг."
series: comentario
software: comentario
---

Вышла версия [Comentario **3.10.0 Donaghadee**](https://gitlab.com/comentario/comentario/-/releases/v3.10.0).

[Comentario](/software/comentario) — это быстрый и мощный свободный сервер комментариев для веб-страниц, написанный на {{< fl "Go" >}}.

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1726409725/blog/ni6elgzbaxv5cemqgbga.jpg" "Киберизображение." >}}

> **Важное объявление:** если вас в моём блоге интересуют только новости {{< fl "Comentario" >}}, добавьте в закладки [соответствующую страницу подборки](/series/comentario). Также доступна {{< rss-permalink "/series/comentario" `<i class="fas fa-rss"></i> RSS-лента` >}} с соответствующими постами.

## Что нового

<!--more-->

### Спиннеры

Отныне {{< fl "Comentario" >}} будет отображать спиннеры (вращающуюся анимацию) во время (потенциально) продолжительных операций, таких как логин, отправка комментария, голосование за коммент и т.п. ([#94](https://gitlab.com/comentario/comentario/-/issues/94)):

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1726413253/blog/ed80vo45b8wq2gwgz5i3.gif" "Спиннеры, показываемые во время сетевых операций." "border shadow" >}}

Также исправлена ещё одна проблема, связанная с отправкой коммента: кнопка `Добавить комментарий` становится недоступной после первого клика, делая невозможной повторную отправку того же комментария ([#116](https://gitlab.com/comentario/comentario/-/issues/116)).

### Обработка вариантов языка

Добавлена обработка цепочки вариантов языка ([#121](https://gitlab.com/comentario/comentario/-/issues/121), за что благодарность [@Func86](https://gitlab.com/Func86)). Если не найдено языка, чей код полностью соответствует запрошенному страницей, встраиваемый {{< fl "Comentario" >}} сначала попробует найти подходящую альтернативу среди родственных региональных вариантов, потом — если такого не нашлось — дженерик-вариант для данного языка и, в конце концов, язык по умолчанию (английский).

Для ценителей привожу диаграмму поиска альтернатив языковых вариантов, которая примерно соответствует алгоритму, используемому в {{< fl "Comentario" >}}:

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1726414283/blog/y75umj77wx8oew8vefac.svg" "Диаграмма языковых вариантов." >}}

### Свойства комментария

Страница свойств комментария теперь отображает текст коммента в {{< fl "HTML" >}} и его «исходник» в {{< fl "Markdown" >}}:

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1726415184/blog/xvnqfrjmkq158dd2ogbj.gif" "Текст в свойствах комментария." "border shadow" >}}

### Свойства пользователя домена

Владельцы домена получили возможность менять настройки подписки своих пользователей на уведомления на странице редактирования пользователя ([#119](https://gitlab.com/comentario/comentario/-/issues/119)):

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1726415390/blog/qwsyfnflb4ccde4f7qrv.png" "Страница редактирования пользователя домена с новыми настройками." "border shadow" >}}

### Поддержка IPv6

{{< fl "Comentario" >}} наконец-то полностью поддерживает регистрацию {{< fl "IPv6" >}}-адресов — был исправлен баг ([#95](https://gitlab.com/comentario/comentario/-/issues/95)) в таблицах БД, хранящих пользователей и комменты. В качестве бонуса, в свойствах пользователя и комментария теперь также отображаются соответствующие {{< fl "IP" >}}-адрес и страна — см. пример ниже. Кстати, по умолчанию {{< fl "Comentario" >}} записывает только первые два байта адреса.

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1726415703/blog/njepket0e6piqlyfaw5e.png" "IP-адрес и страна пользователя." "border shadow" >}}

### Документация

В данном релизе существенно улучшена [документация по Comentario](https://docs.comentario.app/):

* Добавлен раздел [Architecture](https://docs.comentario.app/en/about/architecture/) ([#117](https://gitlab.com/comentario/comentario/-/issues/117)).
* Добавлена ссылка {{< fl "Read on" >}} после фрагмента текста дочерней страницы.
* Исправлена и улучшена функция [поиска](https://docs.comentario.app/en/search/):
    * Результаты теперь ранжируются в зависимости от места, где найдено совпадение, и количества совпадений.
    * Поиск перезапускается при навигации назад-вперёд в браузере.
    * Добавлен счётчик количества найденных страниц.

### Прочие изменения

* Встраиваемая часть: применение `Intl.RelativeTimeFormat` для отображения относительного времени ([#122](https://gitlab.com/comentario/comentario/-/issues/122))
* Встраиваемая часть: при наведении мыши на строку времени отображаются локальные дата и время
* Встраиваемая часть: исправлено отображение блоков кода, чтобы они не были шире карточки с комментом ([#110](https://gitlab.com/comentario/comentario/-/issues/110))
* Встраиваемая часть: добавлено использование юнит-тестов на {{< fl "Jest" >}}
* Встраиваемая часть: по умолчанию выполняется только `build`; `test` и `lint` нужно запускать явно
* Админка: улучшено отображение плейсхолдеров в процессе загрузки главной страницы
* Локализация: добавлены переводы на китайский язык
* Локализация: увеличена длина столбца `lang_id` в таблице пользователей до **255** символов ([#107](https://gitlab.com/comentario/comentario/-/issues/107))
* Документация: расширено описание для самостоятельного хостинга
* Документация: осуществлён переход на использование {{< fl "Hugo environments" >}}
* Документация: добавлена ссылка на блог {{< fl "Comentario" >}} в `README`
* Добавлена поддержка атрибутов пользователя
* {{< fl "Docker" >}}: исправлено предупреждение о `ENV`
* {{< fl "CI" >}}: сборочный пайплайн теперь запускается в любой ветке репозитория; публикация возможна по-прежнему лишь из `dev` или тега
* Для сборки теперь требуется {{< fl "Go" >}} версии 1.23.0+

{{< include-file "/blog/_snippets/_comentario-footer.ru.md" >}}

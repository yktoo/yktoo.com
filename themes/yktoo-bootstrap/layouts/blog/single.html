{{ define "title" }}{{ .Title | markdownify }} | {{ .Site.Title }}{{ end }}

{{ define "schema-dot-org" }}
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  {{- /* Google recommends the headline be no more than 110 characters */}}
  "headline": "{{ substr .Title 0 110 }}",
  {{- with .Params.images -}}{{ range first 1 . }}
  "image": {
    "@type": "ImageObject",
    "url": "{{ . | absURL }}"
    {{- /* Don't try to get imageConfig if image param is not local */ -}}
    {{- if not (or (hasPrefix . "http://") (hasPrefix . "https://")) -}}
    {{- with (imageConfig (printf "/static/%s" .)) -}}
    ,
    "height": "{{ .Height }}",
    "width": "{{ .Width }}"
    {{- end -}}
    {{ end }}
  },
  {{- end -}}{{ end }}
  "url": "{{ printf "%s" .Permalink }}",
  "wordCount": "{{ .WordCount }}",
  {{- $ISO8601 := "2006-01-02T15:04:05-07:00" }}
  {{- if not .PublishDate.IsZero }}
  "datePublished": {{ .PublishDate.Format $ISO8601 }},
  {{- else }}
  "datePublished": {{ .Date.Format $ISO8601 }},
  {{- end }}
  {{- if not .Lastmod.IsZero }}
  "dateModified": {{ .Lastmod.Format $ISO8601 }},
  {{- end }}
  {{- with .Site.Social.GooglePlus }}
  "publisher": "{{ printf "%s" . }}",
  {{- end }}
  "author": {
    "@type": "Person",
    "name": "{{ .Params.author | default .Site.Params.author }}"
  }
  {{- if or (.Params.keywords) (or (.Params.categories) (.Params.tags)) -}}
  ,
  "keywords": "{{ delimit (union .Params.keywords (union .Params.categories .Params.tags)) ", " }}"
  {{- end }}

  {{- with .Params.description -}}
  ,
  "description": "{{ . }}"
  {{- end }}
}
</script>

{{ end }}

{{ define "heading" }}
    <!-- Top previous-next post link bar -->
    <div class="col">
        <nav class="paginator-before" aria-label="Blog navigation">{{ partial "blog/post_nav" . }}</nav>
    </div>

    <!-- Post title -->
    <h1>{{ with .Params.group }}{{ . }}&nbsp;â€£&nbsp;{{ end }}{{ .Title | markdownify }}</h1>
{{ end }}

{{ define "main" }}
{{ $dateFormat := default "Mon Jan 2, 2006" (index .Site.Params "date_format") }}

<article class="blog-post-single">

    <!-- Post metadata -->
    <p class="blog-post-meta"><time datetime="{{ .Date.Format `2006-01-02T15:04:05Z07:00` }}">{{ .Date.Format $dateFormat }}</time> {{ T "authoredBy" }} {{ .Params.author | default .Site.Params.author }}{{ if or (.Params.categories) (.Params.tags) }} {{ T "postedIn" }}{{ end }}</p>

    <!-- Post content -->
    {{ .Content }}

    <!-- Full-text link, if any -->
    {{ with .Params.fulltext_url }}
    <p><a href="{{ . }}" class="btn btn-primary">{{ T "readOnAt" }}&nbsp;{{ (urls.Parse .).Host }}</a></p>
    {{ end }}

    <!-- Post footer -->
    <div class="blog-post-footer">

        <!-- TODO render post group -->

        <!-- Links to translations -->
        {{ if .IsTranslated }}
        <p>
            {{- T "postInLangs" -}}&nbsp;
            {{- range $idx, $translation := .Translations }}{{ if $idx }}, {{ end -}}
            <a href="{{ .Permalink }}">{{ T (print "postIn_" .Lang) }}</a>
            {{- end -}}
        </p>
        {{ end }}

        <!-- Tags etc. -->
        {{ partial "meta-terms.html" . }}

        <!-- Sharing buttons -->
        {{ partial "blog/post_share" . }}

        <!-- TODO comments -->

    </div>


</article>

<!-- Bottom previous-next post link bar -->
<div class="col">
    <nav class="paginator-after" aria-label="Blog navigation">{{ partial "blog/post_nav" . }}</nav>
</div>

{{ end }}

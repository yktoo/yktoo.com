{{ define "secondary-navbar" }}
{{ partial "blog/navbar" . }}
{{ end }}

{{ define "main" }}
<!-- Legend -->
<div class="d-none d-lg-block float-right">
    <h4>{{ T "iAmLegend" }}</h4>
    <ul class="list-unstyled">
        {{- range .Site.Languages }}
        <li><span class="post_{{ .Lang }}"></span>&nbsp;{{ T "post" }} {{ T (print "postIn_" .Lang) }}</li>
        {{ end -}}
    </ul>
</div>

<!-- Post list -->
{{- $dateFormat := default "Jan 2, 2006" (index .Site.Params "short_date_format") -}}
{{- $page := . -}}
<table class="blog-post-list"><tbody>
    {{- $year := 0 -}}
    {{- $list := where .Site.RegularPages "Type" "blog" -}}
    {{- $count := len $list -}}
    {{- range $idx, $post := $list -}}

        <!-- Year heading - if the year has changed   -->
        {{- if not (eq $year .Date.Year) -}}
            {{- $year = .Date.Year -}}
            <tr><th colspan="3">{{ $year }}</th></tr>
        {{- end -}}

        <!-- Output a post row -->
        <tr>
            <td class="number">{{ sub $count $idx }}.</td>
            <td class="date"><time datetime="{{ .Date.Format `2006-01-02T15:04:05Z07:00` }}">{{ .Date.Format $dateFormat }}</time></td>
            <td>{{ partial "blog/post_link.html" (dict "page" $page "post" .) }}</td>
        </tr>
    {{ end }}
</tbody></table>
{{ end }}